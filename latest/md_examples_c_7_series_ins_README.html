<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MIP_SDK: 7 Series INS Example (C)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MIP_SDK
   &#160;<span id="projectnumber">v3.0.0-733-g822ad7b2</span>
   </div>
   <div id="projectbrief">MicroStrain Communications Library for embedded systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">7 Series INS Example (C) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example demonstrates how to configure the navigation filter with external heading, and GNSS position and velocity as the heading sources to stream filter data using simulated external aiding measurements on a MicroStrain 7-series INS device with the MIP SDK using the C API.</p>
<h1><a class="anchor" id="autotoc_md272"></a>
Overview</h1>
<p>The example showcases the basic setup and operation of a 7-series INS device, including:</p><ul>
<li>Device initialization and communication</li>
<li>Filter message format configuration</li>
<li>Gyro bias capture</li>
<li>External aiding measurements configuration</li>
<li>Reference frame setup for external sensors</li>
<li>Filter initialization and heading source configuration</li>
<li>Real-time data streaming and display</li>
</ul>
<h1><a class="anchor" id="autotoc_md273"></a>
Configurable Options</h1>
<p>The example uses the following default settings, which should be adjusted based on application requirements:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Setting </th><th class="markdownTableHeadNone">Value </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>PORT_NAME</code> </td><td class="markdownTableBodyNone"><code>"COM1"</code> (Windows)<br  />
<code>"/dev/ttyACM0"</code> (Unix) </td><td class="markdownTableBodyNone">Serial port for device communication  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>BAUDRATE</code> </td><td class="markdownTableBodyNone"><code>115200</code> </td><td class="markdownTableBodyNone">Communication baud rate  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SAMPLE_RATE_HZ</code> </td><td class="markdownTableBodyNone"><code>1</code> </td><td class="markdownTableBodyNone">Data output rate in Hz  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>RUN_TIME_SECONDS</code> </td><td class="markdownTableBodyNone"><code>30</code> </td><td class="markdownTableBodyNone">Example runtime duration  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md274"></a>
External Aiding Configuration</h1>
<p>The example configures three reference frames for external measurements:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Frame ID </th><th class="markdownTableHeadNone">Purpose </th><th class="markdownTableHeadNone">Translation </th><th class="markdownTableHeadNone">Rotation  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>1</code> </td><td class="markdownTableBodyNone">External Heading </td><td class="markdownTableBodyNone">[0, 0, 0] m </td><td class="markdownTableBodyNone">[0, 0, 0] deg  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>2</code> </td><td class="markdownTableBodyNone">GNSS Antenna </td><td class="markdownTableBodyNone">[0, 1, 0] m </td><td class="markdownTableBodyNone">[0, 0, 0] deg  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>3</code> </td><td class="markdownTableBodyNone">Body Velocity </td><td class="markdownTableBodyNone">[1, 0, 0] m </td><td class="markdownTableBodyNone">[0, 0, 90] deg  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md275"></a>
Usage</h1>
<ol type="1">
<li>Connect your 7-series INS device to the specified serial port</li>
<li>Update the <a href="#configurable-options">configuration options</a> based on your application needs</li>
<li>Compile and run the example</li>
<li>Follow the gyro bias capture prompt (keep the device stationary)</li>
<li>The program will:<ul>
<li>Initialize the device</li>
<li>Configure data streaming</li>
<li>Wait for the filter to reach full navigation mode</li>
<li>Stream data for the specified runtime</li>
<li>Display filter state transitions</li>
<li>Display real-time filter data</li>
<li>Clean up and exit</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md276"></a>
Building</h1>
<h2><a class="anchor" id="autotoc_md277"></a>
With CMake (Recommended)</h2>
<p>The project can be configured on its own using the supplied <a href="CMakeLists.txt">CMakeLists.txt</a>. The file is configured to work directly in the MIP SDK project or as a standalone project. If building outside the MIP SDK project, all that's needed is to define <code>MIP_SDK_ROOT_DIR</code>. When building within the MIP SDK project, make sure to enable the examples using the <code>MICROSTRAIN_BUILD_EXAMPLES</code> CMake option.</p>
<h3><a class="anchor" id="autotoc_md278"></a>
Standalone Command Line</h3>
<div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake .. -DMIP_SDK_ROOT_DIR:PATH=&lt;path_to_mip_sdk&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md279"></a>
Without CMake</h2>
<p>If the project cannot be configured using CMake, then the following project configurations are required:</p>
<h3><a class="anchor" id="autotoc_md280"></a>
Required Libraries</h3>
<p>Link against these libraries:</p><ul>
<li><code>mip</code> - Core MIP SDK library</li>
<li><code>microstrain</code> - Core MicroStrain SDK library</li>
<li><code>microstrain_serial</code> - MicroStrain serial communication library</li>
</ul>
<p>Make sure to include those library paths as additional link directories if needed</p>
<h3><a class="anchor" id="autotoc_md281"></a>
Include Directories</h3>
<p>Add these include directories:</p><ul>
<li><code>[path_to_mip_sdk_include]/c</code></li>
<li><code>[path_to_project_root]</code></li>
</ul>
<p><code>path_to_mip_sdk_include</code> can be installed paths or source paths:</p><ul>
<li>Unix - <code>/usr/include/microstrain</code></li>
<li>Windows - <code>C:/Program Files/MIP_SDK/include/microstrain</code></li>
<li>Source: <code>[mip_sdk_project_root]/src</code></li>
</ul>
<h3><a class="anchor" id="autotoc_md282"></a>
Compiler Definitions</h3>
<p>Add these compiler definitions:</p><ul>
<li><code>MICROSTRAIN_LOGGING_MAX_LEVEL=MICROSTRAIN_LOGGING_LEVEL_INFO_</code> Sets the logging level to info which is the minimum required for this example</li>
</ul>
<h1><a class="anchor" id="autotoc_md283"></a>
Key Functions</h1>
<h2><a class="anchor" id="autotoc_md284"></a>
Device Setup</h2>
<ul>
<li><code><a class="el" href="group____5__series__ahrs__example__c.html#gaee4d8db1c6a3b49e5c6c6c94ecece049" title="Initializes and configures a MIP device interface.">initialize_device()</a></code> - Establishes communication, validates device connection, and loads defaults</li>
<li><code><a class="el" href="group____5__series__ahrs__example__c.html#gab7873ad706bb08f8d9fdddb2716c6a20" title="Captures and configures device gyro bias.">capture_gyro_bias()</a></code> - Captures and applies gyroscope bias compensation</li>
<li><code><a class="el" href="group____7__series__ins__example__c.html#ga815eea2e89ab841c0f975507aae37780" title="Configures a heading reference frame for external aiding measurements.">configure_external_aiding_heading()</a></code> - Sets up a reference frame for external heading sensor data</li>
<li><code><a class="el" href="group____7__series__ins__example__c.html#ga402509f568a71c794e45a09727e96e22" title="Configures a GNSS antenna reference frame for external aiding measurements.">configure_external_aiding_gnss_antenna()</a></code> - Sets up a reference frame for external GNSS antenna sensor data</li>
<li><code><a class="el" href="group____7__series__ins__example__c.html#gaac44223af16202cfd06014f738035cde" title="Configures a body frame velocity reference frame for external aiding measurements.">configure_external_aiding_ned_velocity()</a></code> - Sets up a reference frame for external NED velocity sensor data</li>
<li><code><a class="el" href="group____5__series__ahrs__example__c.html#gae83d0cad66c985fd50c767b7331c4491" title="Initializes and resets the navigation filter.">initialize_filter()</a></code> - Initializes the navigation filter with GNSS position and velocity, and external heading as the heading sources</li>
</ul>
<h2><a class="anchor" id="autotoc_md285"></a>
Message Configuration</h2>
<ul>
<li><code><a class="el" href="group____5__series__ahrs__example__c.html#gaf4c03c5087ef10fd8c712870362f07ac" title="Configures message format for filter data streaming.">configure_filter_message_format()</a></code> - Configures filter/navigation data output including:<ul>
<li>GPS timestamp</li>
<li>Filter status</li>
<li>LLH position coordinates</li>
<li>NED velocity vectors</li>
<li>Euler angles (roll, pitch, yaw)</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md286"></a>
Data Display</h2>
<ul>
<li><code><a class="el" href="group____5__series__ahrs__example__c.html#ga502b5c976493d4638f608e797f77b149" title="Displays the current filter state when changes occur.">display_filter_state()</a></code> - Displays navigation filter operating mode changes</li>
</ul>
<h2><a class="anchor" id="autotoc_md287"></a>
Communication Interface</h2>
<ul>
<li>Uses the <code>mip_interface</code> struct for device communication</li>
<li>Serial connection handled by <code><a class="el" href="structserial__port.html">serial_port</a></code></li>
</ul>
<h2><a class="anchor" id="autotoc_md288"></a>
External Data Simulation</h2>
<ul>
<li><code>send_simulated_external_measurements_heading()</code> - Simulates external heading measurements</li>
<li><code>send_simulated_external_measurements_position()</code> - Provides external position updates</li>
<li><code>send_simulated_external_measurements_ned_velocity()</code> - Sends NED velocity measurements</li>
<li><code>send_simulated_external_measurements_vehicle_frame_velocity()</code> - Provides body-frame velocity data</li>
</ul>
<h1><a class="anchor" id="autotoc_md289"></a>
Data Handling</h1>
<p>This example demonstrates traditional C programming patterns:</p><ul>
<li><b>Manual Parsing</b>: Direct parsing of incoming MIP packets using the MIP parser</li>
<li><b>Callback Functions</b>: Function pointer-based callbacks for data processing</li>
<li><b>Explicit Memory Management</b>: Manual buffer and resource management</li>
<li><b>Type Safety</b>: Uses C structs and enums for data type safety</li>
<li><b>Error Codes</b>: Command results handled through return codes and error checking</li>
</ul>
<h1><a class="anchor" id="autotoc_md290"></a>
C Implementation Features</h1>
<p>This example showcases:</p><ul>
<li><b>MIP Interface</b>: Core C interface for device communication (<code>mip_interface</code>)</li>
<li><b>Serial Port Management</b>: Low-level serial port operations</li>
<li><b>Parser Integration</b>: Direct use of the MIP packet parser</li>
<li><b>Memory Safety</b>: Careful buffer management and bound checking</li>
<li><b>Portability</b>: Cross-platform compatibility (Windows/Unix)</li>
</ul>
<h1><a class="anchor" id="autotoc_md291"></a>
External Measurement Simulation</h1>
<p>The example provides simulated external data for demonstration:</p><ul>
<li><b>Heading</b>: 0.0° (North) with 0.001 rad uncertainty</li>
<li><b>Position</b>: MicroStrain headquarters coordinates (44.437°N, 73.106°W, 122m)</li>
<li><b>Velocity</b>: Stationary [0, 0, 0] m/s with 0.1 m/s uncertainty (both NED and body frame)</li>
</ul>
<h1><a class="anchor" id="autotoc_md292"></a>
Custom Communication Functions</h1>
<p>The example implements custom communication handlers:</p><ul>
<li><b>Send Function</b>: <code><a class="el" href="group____5__series__ahrs__example__c.html#ga0327b223000a9e4b27b2ba8a53f3ab7c" title="Handles sending packets to the device.">mip_interface_user_send_to_device()</a></code> handles outgoing data</li>
<li><b>Receive Function</b>: <code><a class="el" href="group____5__series__ahrs__example__c.html#ga455fe41f4d60f77e8e8b89ee701f5131" title="Handles receiving packets from the device.">mip_interface_user_recv_from_device()</a></code> manages incoming data</li>
<li><b>Timeout Handling</b>: Configurable timeouts for reliable communication</li>
</ul>
<h1><a class="anchor" id="autotoc_md293"></a>
Filter Data Output</h1>
<p>The example streams the following filter data:</p>
<h2><a class="anchor" id="autotoc_md294"></a>
TOW Data</h2>
<ul>
<li><b>Units</b>: seconds</li>
<li><b>Description</b>: Time of Week - GPS time reference</li>
<li><b>Format</b>: Floating-point timestamp value</li>
</ul>
<h2><a class="anchor" id="autotoc_md295"></a>
Position LLH Data</h2>
<ul>
<li><b>Units</b>:<ul>
<li>Latitude: degrees</li>
<li>Longitude: degrees</li>
<li>Ellipsoid Height: meters</li>
</ul>
</li>
<li><b>Description</b>: Position in Latitude, Longitude, Height coordinate system</li>
<li><b>Format</b>: [Latitude, Longitude, Height] vector</li>
</ul>
<h2><a class="anchor" id="autotoc_md296"></a>
Velocity NED Data</h2>
<ul>
<li><b>Units</b>: m/s (meters per second)</li>
<li><b>Description</b>: Velocity in North, East, Down coordinate frame</li>
<li><b>Format</b>: [North, East, Down] velocity vector</li>
</ul>
<h2><a class="anchor" id="autotoc_md297"></a>
Euler Angles Data</h2>
<ul>
<li><b>Units</b>: radians</li>
<li><b>Description</b>: Orientation expressed as Euler angles</li>
<li><b>Format</b>: [Roll, Pitch, Yaw] angle vector</li>
</ul>
<h1><a class="anchor" id="autotoc_md298"></a>
Streaming Output Format</h1>
<p>The example displays filter data in the following format: </p><div class="fragment"><div class="line">TOW = 123456.789    Position LLH = [ 4.123456, -83.54321,  123.4567]    Velocity NED = [ 1.234567, -0.987654,  0.123456]     Euler Angles = [ 0.012345, -0.067890,  1.234567]</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md299"></a>
Filter State Progression</h1>
<p>The example monitors and displays filter state transitions:</p><ol type="1">
<li><b>Startup</b> - Filter startup</li>
<li><b>Initialization</b> - Filter initialization</li>
<li><b>Vertical Gyro</b> - Basic attitude estimation</li>
<li><b>AHRS</b> - Full attitude and heading reference</li>
<li><b>Full Navigation</b> - Complete navigation solution with position/velocity</li>
</ol>
<h1><a class="anchor" id="autotoc_md300"></a>
Error Handling</h1>
<p>The example includes comprehensive error handling with:</p><ul>
<li>Command result checking using <code>mip_cmd_result</code></li>
<li>Connection failure detection and recovery</li>
<li>Graceful termination functions for different error types</li>
<li>Detailed error messages with context</li>
</ul>
<h1><a class="anchor" id="autotoc_md301"></a>
C Features</h1>
<p>This example demonstrates:</p><ul>
<li>Standard C11 programming practices</li>
<li>Minimal external dependencies</li>
<li>Direct hardware interface programming</li>
<li>Efficient memory usage patterns</li>
<li>Cross-platform serial communication</li>
</ul>
<h1><a class="anchor" id="autotoc_md302"></a>
Requirements</h1>
<ul>
<li>MicroStrain 7-series INS device (3DM-CV7-INS, or 3DM-GV7-INS)</li>
<li>Serial connection (USB or RS-232)</li>
<li>MIP SDK library with C support</li>
<li>C11 or later compiler</li>
<li>External sensors for real-world implementation (optional for demo)</li>
</ul>
<h1><a class="anchor" id="autotoc_md303"></a>
See Also</h1>
<ul>
<li>C++ version: <code><a class="el" href="7__series__ins__example_8cpp.html">7_series_ins_example.cpp</a></code></li>
<li>Other examples in the <code>examples/</code> directory</li>
<li><a href="https://lord-microstrain.github.io/mip_sdk_documentation/">MIP SDK documentation</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
