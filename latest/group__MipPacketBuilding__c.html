<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MIP_SDK: Packet Building</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MIP_SDK
   &#160;<span id="projectnumber">v3.0.0-501-ge6bf4d9</span>
   </div>
   <div id="projectbrief">MicroStrain Communications Library for embedded systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Packet Building<div class="ingroups"><a class="el" href="group__mip.html">MIP</a> &raquo; <a class="el" href="group__mip__c.html">MIP C API</a> &raquo; <a class="el" href="group__mip__packet__c.html">Mip Packet</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for building new MIP packets.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa0ee7777331b8dc4141c1a08f8ca01cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MipPacketBuilding__c.html#gaa0ee7777331b8dc4141c1a08f8ca01cf">mip::C::mip_packet_create</a> (<a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *packet, uint8_t *buffer, size_t buffer_size, uint8_t descriptor_set)</td></tr>
<tr class="memdesc:gaa0ee7777331b8dc4141c1a08f8ca01cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a brand-new MIP packet in the given buffer.  <a href="group__MipPacketBuilding__c.html#gaa0ee7777331b8dc4141c1a08f8ca01cf">More...</a><br /></td></tr>
<tr class="separator:gaa0ee7777331b8dc4141c1a08f8ca01cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5749e64bb20e3b5e1c44d3ed0b7321eb"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MipPacketBuilding__c.html#ga5749e64bb20e3b5e1c44d3ed0b7321eb">mip::C::mip_packet_add_field</a> (<a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *packet, uint8_t field_descriptor, const uint8_t *payload, uint8_t payload_length)</td></tr>
<tr class="memdesc:ga5749e64bb20e3b5e1c44d3ed0b7321eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a pre-constructed MIP field to the packet.  <a href="group__MipPacketBuilding__c.html#ga5749e64bb20e3b5e1c44d3ed0b7321eb">More...</a><br /></td></tr>
<tr class="separator:ga5749e64bb20e3b5e1c44d3ed0b7321eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab5e555509f57f6b7b2d0b1434a2a106"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MipPacketBuilding__c.html#gaab5e555509f57f6b7b2d0b1434a2a106">mip::C::mip_packet_create_field</a> (<a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *packet, uint8_t field_descriptor, uint8_t payload_length, uint8_t **payload_ptr_out)</td></tr>
<tr class="memdesc:gaab5e555509f57f6b7b2d0b1434a2a106"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a MIP field within the packet and return the payload pointer.  <a href="group__MipPacketBuilding__c.html#gaab5e555509f57f6b7b2d0b1434a2a106">More...</a><br /></td></tr>
<tr class="separator:gaab5e555509f57f6b7b2d0b1434a2a106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4457b5b8eab775ba6beec5fa1c828476"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MipPacketBuilding__c.html#ga4457b5b8eab775ba6beec5fa1c828476">mip::C::mip_packet_update_last_field_length</a> (<a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *packet, uint8_t *payload_ptr, uint8_t new_payload_length)</td></tr>
<tr class="memdesc:ga4457b5b8eab775ba6beec5fa1c828476"><td class="mdescLeft">&#160;</td><td class="mdescRight">Changes the size of the last field in the packet.  <a href="group__MipPacketBuilding__c.html#ga4457b5b8eab775ba6beec5fa1c828476">More...</a><br /></td></tr>
<tr class="separator:ga4457b5b8eab775ba6beec5fa1c828476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaece2d00f4d6cb74109d19c8d0d717561"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MipPacketBuilding__c.html#gaece2d00f4d6cb74109d19c8d0d717561">mip::C::mip_packet_cancel_last_field</a> (<a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *packet, uint8_t *payload_ptr)</td></tr>
<tr class="memdesc:gaece2d00f4d6cb74109d19c8d0d717561"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the last field from the packet after having allocated it.  <a href="group__MipPacketBuilding__c.html#gaece2d00f4d6cb74109d19c8d0d717561">More...</a><br /></td></tr>
<tr class="separator:gaece2d00f4d6cb74109d19c8d0d717561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2200d6640283cca2532f82a07fdf6679"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MipPacketBuilding__c.html#ga2200d6640283cca2532f82a07fdf6679">mip::C::mip_packet_finalize</a> (<a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *packet)</td></tr>
<tr class="memdesc:ga2200d6640283cca2532f82a07fdf6679"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares the packet for transmission by adding the checksum.  <a href="group__MipPacketBuilding__c.html#ga2200d6640283cca2532f82a07fdf6679">More...</a><br /></td></tr>
<tr class="separator:ga2200d6640283cca2532f82a07fdf6679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa5892c3a54ac524fff31eebc6fc6298d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__MipPacketBuilding__c.html#gaa5892c3a54ac524fff31eebc6fc6298d">mip::C::mip_packet_reset</a> (<a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *packet, uint8_t descriptor_set)</td></tr>
<tr class="memdesc:gaa5892c3a54ac524fff31eebc6fc6298d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reinitialize the packet with the given descriptor set.  <a href="group__MipPacketBuilding__c.html#gaa5892c3a54ac524fff31eebc6fc6298d">More...</a><br /></td></tr>
<tr class="separator:gaa5892c3a54ac524fff31eebc6fc6298d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions for building new MIP packets. </p>
<p>Use these functions to create a new packet, add fields, and write the checksum. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga5749e64bb20e3b5e1c44d3ed0b7321eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5749e64bb20e3b5e1c44d3ed0b7321eb">&#9670;&nbsp;</a></span>mip_packet_add_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool mip::C::mip_packet_add_field </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>field_descriptor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>payload_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a pre-constructed MIP field to the packet. </p>
<div class="fragment"><div class="line">                                            +--------------------+</div>
<div class="line">                                            |  Payload Bytes     |</div>
<div class="line">                              Len  Desc     +--------------------+</div>
<div class="line">                               |    |        | copy</div>
<div class="line"> Packet Buffer                 V    V        V</div>
<div class="line">---------------+------------+-   -+-    -+--                  -+-</div>
<div class="line"> ...   Header  |   Field    | Len | Desc |  Payload            |</div>
<div class="line">---------------+------------+-----+------+---------------------+----------</div>
<div class="line">                            |                                  |</div>
<div class="line">                    End of last field   ---------------&gt;  End of <span class="keyword">new</span> field</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td></td></tr>
    <tr><td class="paramname">field_descriptor</td><td>The MIP field descriptor (e.g. command or data descriptor). </td></tr>
    <tr><td class="paramname">payload</td><td>A pointer to the field payload data (without the header). Can be NULL if payload_length is 0. </td></tr>
    <tr><td class="paramname">payload_length</td><td>The length of the payload data. Must be less than or equal to MIP_FIELD_PAYLOAD_LENGTH_MAX. Does not include the header.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the field was added, or false if there was not enough space. </dd></dl>

</div>
</div>
<a id="gaece2d00f4d6cb74109d19c8d0d717561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaece2d00f4d6cb74109d19c8d0d717561">&#9670;&nbsp;</a></span>mip_packet_cancel_last_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mip::C::mip_packet_cancel_last_field </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>payload_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes the last field from the packet after having allocated it. </p>
<p>Use only after allocating a field with mip_packet_create_field to cancel it. E.g. if it turns out that there isn't enough buffer space to write the payload.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td></td></tr>
    <tr><td class="paramname">payload_ptr</td><td>Pointer to the field payload. This must be the same value returned from alloc_field and must point to the last field.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The remaining space in the packet after removing the field. </dd></dl>

</div>
</div>
<a id="gaa0ee7777331b8dc4141c1a08f8ca01cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa0ee7777331b8dc4141c1a08f8ca01cf">&#9670;&nbsp;</a></span>mip_packet_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mip::C::mip_packet_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buffer_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>descriptor_set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a brand-new MIP packet in the given buffer. </p>
<p>Use this along with the packet building functions to create MIP packets.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td></td></tr>
    <tr><td class="paramname">buffer</td><td>This is where the packet bytes will be stored. Must be at least MIP_PACKET_LENGTH_MIN bytes in size. </td></tr>
    <tr><td class="paramname">buffer_size</td><td>The size of buffer, in bytes. </td></tr>
    <tr><td class="paramname">descriptor_set</td><td>The MIP descriptor set for the packet. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gaab5e555509f57f6b7b2d0b1434a2a106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaab5e555509f57f6b7b2d0b1434a2a106">&#9670;&nbsp;</a></span>mip_packet_create_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mip::C::mip_packet_create_field </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>field_descriptor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>payload_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t **&#160;</td>
          <td class="paramname"><em>payload_ptr_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a MIP field within the packet and return the payload pointer. </p>
<div class="fragment"><div class="line">                              Len   Desc  .---&gt; Payload ptr out</div>
<div class="line">                               |     |    |</div>
<div class="line"> Packet Buffer                 V     V    |</div>
<div class="line">---------------+------------+-   -+-    -+---------------------+----------</div>
<div class="line"> ...   Header  |   Field    | Len | Desc | (unwritten payload) |</div>
<div class="line">---------------+------------+-----+------+---------------------+----------</div>
<div class="line">                            |                                  |</div>
<div class="line">                    End of last field   ---------------&gt;  End of <span class="keyword">new</span> field</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td></td></tr>
    <tr><td class="paramname">field_descriptor</td><td>The MIP field descriptor (e.g. command or data descriptor). </td></tr>
    <tr><td class="paramname">payload_length</td><td>The requested length of the field payload (not including the header). If the size is not known ahead of time, pass 0 and inspect the return value to see how much payload data can be written. Then call mip_packet_realloc_field() with the used size and same payload pointer. </td></tr>
    <tr><td class="paramname">payload_ptr_out</td><td>A pointer to a pointer to the field payload. This will receive the payload pointer into which data should be written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The amount of space remaining after allocating this field. If this is negative, the field could not be allocated and the payload must not be written. </dd></dl>

</div>
</div>
<a id="ga2200d6640283cca2532f82a07fdf6679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2200d6640283cca2532f82a07fdf6679">&#9670;&nbsp;</a></span>mip_packet_finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mip::C::mip_packet_finalize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *&#160;</td>
          <td class="paramname"><em>packet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepares the packet for transmission by adding the checksum. </p>
<p>This does not increase the total packet length since the checksum is always implicitly included.</p>
<div class="fragment"><div class="line">                                                         Checksum</div>
<div class="line">                                                           VVVV</div>
<div class="line">---------------+------------+------------+-----<span class="comment">//-----+--        --+----</span></div>
<div class="line"> ...   Header  |   Field    |   Field    |     ...    |  (empty)   |</div>
<div class="line">---------------+------------+------------+-----<span class="comment">//-----+------------+----</span></div>
<div class="line">                                                      |            |</div>
<div class="line">                                           End of last field       |</div>
<div class="line">                                                              Total Length</div>
</div><!-- fragment --> 
</div>
</div>
<a id="gaa5892c3a54ac524fff31eebc6fc6298d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa5892c3a54ac524fff31eebc6fc6298d">&#9670;&nbsp;</a></span>mip_packet_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mip::C::mip_packet_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>descriptor_set</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reinitialize the packet with the given descriptor set. </p>
<p>This clears out all of the fields but keeps the same buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td></td></tr>
    <tr><td class="paramname">descriptor_set</td><td>New descriptor set. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga4457b5b8eab775ba6beec5fa1c828476"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4457b5b8eab775ba6beec5fa1c828476">&#9670;&nbsp;</a></span>mip_packet_update_last_field_length()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mip::C::mip_packet_update_last_field_length </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmip_1_1C_1_1mip__packet__view.html">mip_packet_view</a> *&#160;</td>
          <td class="paramname"><em>packet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>payload_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>new_payload_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Changes the size of the last field in the packet. </p>
<p>Use this in conjunction with <a class="el" href="group__MipPacketBuilding__c.html#gaab5e555509f57f6b7b2d0b1434a2a106" title="Allocate a MIP field within the packet and return the payload pointer.">mip_packet_create_field()</a> when the size of the field is not known in advance. Pass a payload size of 0 to alloc_field and check that the returned available space is sufficient, then write the payload and call this function with the actual space used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td></td></tr>
    <tr><td class="paramname">payload_ptr</td><td>Pointer to the field payload. This must be the same value returned from alloc_field and must point to the last field. </td></tr>
    <tr><td class="paramname">new_payload_length</td><td>Length of payload written. Generally it is an error for this to exceed the actual amount of space available in the packet. In this case, the packet is left with just the empty field and the return value will be negative.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The space remaining in the packet after changing the field size. This will be negative if the new length did not fit. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
